import{r as L,u as T,j as e,H as V,L as C}from"./app-4QF1noMb.js";import{A as E}from"./app-layout-DlOP7P_7.js";import{B as u}from"./button-DBIL1Z8B.js";import{C as R,a as I,b as k,c as q,d as H}from"./card-DR06hP1e.js";import{I as p}from"./input-DvwVAa8V.js";import{L as i}from"./label-GMjfTP0s.js";import{S as x,a as j,b as v,c as f,d as l}from"./select-lsPa0R9A.js";import{A as M}from"./arrow-left-C7Q7q3fr.js";import{P as B}from"./plus-CLjpwHAf.js";import{T as J}from"./trash-2-DPTzMbDY.js";import{S as O}from"./save-BuwhOsbz.js";/* empty css            */import"./utils-BULDOeo9.js";import"./index-DoGIkioa.js";import"./index-ConwksJU.js";import"./createLucideIcon-6dVE3Vd0.js";import"./index-pY3kX1L4.js";import"./index-BBqGkt9K.js";import"./index-B2VJWed_.js";import"./index-CHydNK0m.js";import"./index-GDUkZo-u.js";import"./log-out-DHJl1Adr.js";import"./package-B9d4UWXJ.js";import"./shopping-cart-Bl3zxqU1.js";import"./credit-card-yvDc5vsp.js";import"./bell-DCAOnOCR.js";import"./chevron-right-BcqJVpEb.js";import"./index-D9b6Gg7M.js";import"./index-Crbwks2i.js";import"./check-gs7IydId.js";const Y=[{title:"Dashboard",href:"/dashboard"},{title:"Paiements",href:"/paiements"},{title:"Nouveau Paiement",href:"/paiements/create"}];function ye({clients:b,produits:N}){const[o,_]=L.useState([]),{data:d,setData:n,errors:s,post:S,processing:g}=T({reference:`PAY-${Date.now()}`,montant:"",date_paiement:new Date().toISOString().split("T")[0],statut:"en_attente",user_id:"",methode_paiement:{type:"carte",details:""},produits:[]}),P=()=>{_([...o,{id:0,montant_alloue:0,nom:""}])},w=t=>{const r=o.filter((a,h)=>h!==t);_(r),n("produits",r.map(a=>({id:a.id,montant_alloue:a.montant_alloue})))},y=(t,r,a)=>{const h=N.find(m=>m.id===r),c=[...o];h?c[t]={id:r,montant_alloue:a,nom:h.nom}:c[t]={id:r,montant_alloue:a,nom:""},_(c),n("produits",c.map(m=>({id:m.id,montant_alloue:m.montant_alloue})));const z=c.reduce((m,A)=>m+A.montant_alloue,0);n("montant",z.toString())},F=o.reduce((t,r)=>t+r.montant_alloue,0),D=t=>{t.preventDefault(),S("/paiements")};return e.jsxs(E,{breadcrumbs:Y,children:[e.jsx(V,{title:"Créer un Paiement"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(C,{href:"/paiements",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Retour"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Créer un Paiement"}),e.jsx("p",{className:"text-muted-foreground",children:"Enregistrer un nouveau paiement pour un client"})]})]})}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(k,{children:"Informations du Paiement"}),e.jsx(q,{children:"Remplissez les informations pour créer un nouveau paiement"})]}),e.jsx(H,{children:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"reference",children:"Référence *"}),e.jsx(p,{id:"reference",value:d.reference,onChange:t=>n("reference",t.target.value),required:!0}),s.reference&&e.jsx("p",{className:"text-sm text-red-600",children:s.reference})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"date_paiement",children:"Date de paiement *"}),e.jsx(p,{id:"date_paiement",type:"date",value:d.date_paiement,onChange:t=>n("date_paiement",t.target.value),required:!0}),s.date_paiement&&e.jsx("p",{className:"text-sm text-red-600",children:s.date_paiement})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"user_id",children:"Client *"}),e.jsxs(x,{value:d.user_id,onValueChange:t=>n("user_id",t),children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Sélectionnez un client"})}),e.jsx(f,{children:b.map(t=>e.jsxs(l,{value:t.id.toString(),children:[t.name," - ",t.email]},t.id))})]}),s.user_id&&e.jsx("p",{className:"text-sm text-red-600",children:s.user_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"statut",children:"Statut *"}),e.jsxs(x,{value:d.statut,onValueChange:t=>n("statut",t),children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Sélectionnez un statut"})}),e.jsxs(f,{children:[e.jsx(l,{value:"en_attente",children:"En attente"}),e.jsx(l,{value:"paye",children:"Payé"}),e.jsx(l,{value:"echec",children:"Échec"}),e.jsx(l,{value:"rembourse",children:"Remboursé"})]})]}),s.statut&&e.jsx("p",{className:"text-sm text-red-600",children:s.statut})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"methode_type",children:"Méthode de paiement *"}),e.jsxs(x,{value:d.methode_paiement.type,onValueChange:t=>n("methode_paiement",{...d.methode_paiement,type:t}),children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Sélectionnez une méthode"})}),e.jsxs(f,{children:[e.jsx(l,{value:"carte",children:"Carte bancaire"}),e.jsx(l,{value:"virement",children:"Virement"}),e.jsx(l,{value:"paypal",children:"PayPal"}),e.jsx(l,{value:"especes",children:"Espèces"})]})]}),s["methode_paiement.type"]&&e.jsx("p",{className:"text-sm text-red-600",children:s["methode_paiement.type"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"montant",children:"Montant total *"}),e.jsx(p,{id:"montant",type:"number",step:"0.01",min:"0",value:d.montant,onChange:t=>n("montant",t.target.value),placeholder:"0.00",required:!0}),s.montant&&e.jsx("p",{className:"text-sm text-red-600",children:s.montant})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"methode_details",children:"Détails de la méthode de paiement"}),e.jsx(p,{id:"methode_details",value:d.methode_paiement.details,onChange:t=>n("methode_paiement",{...d.methode_paiement,details:t.target.value}),placeholder:"Détails supplémentaires sur la méthode de paiement..."}),s["methode_paiement.details"]&&e.jsx("p",{className:"text-sm text-red-600",children:s["methode_paiement.details"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Produits associés"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:P,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Ajouter un produit"]})]}),o.map((t,r)=>e.jsxs("div",{className:"flex items-end space-x-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(i,{children:"Produit"}),e.jsxs(x,{value:t.id.toString(),onValueChange:a=>y(r,parseInt(a),t.montant_alloue),children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Sélectionnez un produit"})}),e.jsx(f,{children:N.map(a=>e.jsxs(l,{value:a.id.toString(),children:[a.nom," - ",a.prix," €"]},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Montant alloué (€)"}),e.jsx(p,{type:"number",step:"0.01",min:"0",value:t.montant_alloue,onChange:a=>y(r,t.id,parseFloat(a.target.value)||0)})]}),e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>w(r),children:e.jsx(J,{className:"h-4 w-4"})})]},r)),s.produits&&e.jsx("p",{className:"text-sm text-red-600",children:s.produits})]}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("div",{className:"text-lg font-semibold",children:["Total: ",F.toFixed(2)," €"]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(u,{variant:"outline",asChild:!0,children:e.jsx(C,{href:"/paiements",children:"Annuler"})}),e.jsxs(u,{type:"submit",disabled:g||o.length===0,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),g?"Création...":"Créer le paiement"]})]})]})]})})]})]})]})}export{ye as default};
