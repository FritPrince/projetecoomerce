import{r as D,u as q,j as e,H as z,L as S}from"./app-4QF1noMb.js";import{A as F}from"./app-layout-DlOP7P_7.js";import{B as m}from"./button-DBIL1Z8B.js";import{C as L,a as E,b as k,c as I,d as V}from"./card-DR06hP1e.js";import{I as p}from"./input-DvwVAa8V.js";import{L as n}from"./label-GMjfTP0s.js";import{S as j,a as f,b as v,c as C,d as i}from"./select-lsPa0R9A.js";import{A as H}from"./arrow-left-C7Q7q3fr.js";import{P as R}from"./plus-CLjpwHAf.js";import{E as B}from"./euro-Dgiw96Sv.js";import{T as J}from"./trash-2-DPTzMbDY.js";import{S as M}from"./save-BuwhOsbz.js";/* empty css            */import"./utils-BULDOeo9.js";import"./index-DoGIkioa.js";import"./index-ConwksJU.js";import"./createLucideIcon-6dVE3Vd0.js";import"./index-pY3kX1L4.js";import"./index-BBqGkt9K.js";import"./index-B2VJWed_.js";import"./index-CHydNK0m.js";import"./index-GDUkZo-u.js";import"./log-out-DHJl1Adr.js";import"./package-B9d4UWXJ.js";import"./shopping-cart-Bl3zxqU1.js";import"./credit-card-yvDc5vsp.js";import"./bell-DCAOnOCR.js";import"./chevron-right-BcqJVpEb.js";import"./index-D9b6Gg7M.js";import"./index-Crbwks2i.js";import"./check-gs7IydId.js";const O=[{title:"Dashboard",href:"/dashboard"},{title:"Commandes",href:"/commandes"},{title:"Nouvelle Commande",href:"/commandes/create"}];function _e({clients:b,produits:N}){const[d,h]=D.useState([]),{data:c,setData:o,errors:r,post:y,processing:g}=q({numero_commande:`CMD-${Date.now()}`,date_commande:new Date().toISOString().split("T")[0],statut:"en_attente",user_id:"",produits:[]}),w=()=>{h([...d,{id:0,quantite:1,nom:"",prix:0,sousTotal:0}])},T=s=>{const a=d.filter((t,l)=>l!==s);h(a),o("produits",a.map(t=>({id:t.id,quantite:t.quantite})))},_=(s,a,t)=>{const l=N.find(x=>x.id===a),u=[...d];l?u[s]={id:a,quantite:t,nom:l.nom,prix:l.prix,sousTotal:l.prix*t}:u[s]={id:a,quantite:t,nom:"",prix:0,sousTotal:0},h(u),o("produits",u.map(x=>({id:x.id,quantite:x.quantite})))},P=d.reduce((s,a)=>s+a.sousTotal,0),A=s=>{s.preventDefault(),y("/commandes")};return e.jsxs(F,{breadcrumbs:O,children:[e.jsx(z,{title:"Créer une Commande"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(m,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(S,{href:"/commandes",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Retour"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Créer une Commande"}),e.jsx("p",{className:"text-muted-foreground",children:"Créer une nouvelle commande pour un client"})]})]})}),e.jsxs(L,{children:[e.jsxs(E,{children:[e.jsx(k,{children:"Informations de la Commande"}),e.jsx(I,{children:"Remplissez les informations pour créer une nouvelle commande"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"numero_commande",children:"Numéro de commande *"}),e.jsx(p,{id:"numero_commande",value:c.numero_commande,onChange:s=>o("numero_commande",s.target.value),required:!0}),r.numero_commande&&e.jsx("p",{className:"text-sm text-red-600",children:r.numero_commande})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"date_commande",children:"Date de commande *"}),e.jsx(p,{id:"date_commande",type:"date",value:c.date_commande,onChange:s=>o("date_commande",s.target.value),required:!0}),r.date_commande&&e.jsx("p",{className:"text-sm text-red-600",children:r.date_commande})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"user_id",children:"Client *"}),e.jsxs(j,{value:c.user_id,onValueChange:s=>o("user_id",s),children:[e.jsx(f,{children:e.jsx(v,{placeholder:"Sélectionnez un client"})}),e.jsx(C,{children:b.map(s=>e.jsxs(i,{value:s.id.toString(),children:[s.name," - ",s.email]},s.id))})]}),r.user_id&&e.jsx("p",{className:"text-sm text-red-600",children:r.user_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"statut",children:"Statut *"}),e.jsxs(j,{value:c.statut,onValueChange:s=>o("statut",s),children:[e.jsx(f,{children:e.jsx(v,{placeholder:"Sélectionnez un statut"})}),e.jsxs(C,{children:[e.jsx(i,{value:"en_attente",children:"En attente"}),e.jsx(i,{value:"confirmee",children:"Confirmée"}),e.jsx(i,{value:"expediee",children:"Expédiée"}),e.jsx(i,{value:"livree",children:"Livrée"}),e.jsx(i,{value:"annulee",children:"Annulée"})]})]}),r.statut&&e.jsx("p",{className:"text-sm text-red-600",children:r.statut})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Produits de la commande"}),e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:w,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Ajouter un produit"]})]}),d.map((s,a)=>e.jsxs("div",{className:"flex items-end space-x-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(n,{children:"Produit"}),e.jsxs(j,{value:s.id.toString(),onValueChange:t=>_(a,parseInt(t),s.quantite),children:[e.jsx(f,{children:e.jsx(v,{placeholder:"Sélectionnez un produit"})}),e.jsx(C,{children:N.map(t=>e.jsxs(i,{value:t.id.toString(),children:[t.nom," - ",t.prix," € (Stock: ",t.stock,")"]},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Quantité"}),e.jsx(p,{type:"number",min:"1",value:s.quantite,onChange:t=>_(a,s.id,parseInt(t.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Sous-total"}),e.jsxs("div",{className:"flex items-center space-x-2 h-10 px-3 border rounded-md",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.sousTotal.toFixed(2)})]})]}),e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>T(a),children:e.jsx(J,{className:"h-4 w-4"})})]},a)),r.produits&&e.jsx("p",{className:"text-sm text-red-600",children:r.produits})]}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("div",{className:"text-lg font-semibold",children:["Total: ",P.toFixed(2)," €"]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(m,{variant:"outline",asChild:!0,children:e.jsx(S,{href:"/commandes",children:"Annuler"})}),e.jsxs(m,{type:"submit",disabled:g||d.length===0,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),g?"Création...":"Créer la commande"]})]})]})]})})]})]})]})}export{_e as default};
